import numpy as np

if __name__ == "__main__":

    # Reconstruct your tensor as a NumPy array
    x = np.array([[[[-0.1867, -0.0714, -0.0284, -0.0534, -0.1250],
          [-0.1853, -0.0358,  0.0176, -0.1298, -0.1078],
          [ 0.0928,  0.0313, -0.1729,  0.1124,  0.1580],
          [-0.0698,  0.0751,  0.0944,  0.0433,  0.0360],
          [ 0.2271,  0.0184,  0.1608,  0.1843, -0.1194]]],


        [[[ 0.0824,  0.0883,  0.1707,  0.0282,  0.1436],
          [-0.1506, -0.1153, -0.0538, -0.0432, -0.0183],
          [ 0.0527,  0.0054,  0.0450,  0.0241, -0.1397],
          [-0.0072,  0.0220, -0.2082,  0.0782,  0.1200],
          [-0.1881, -0.0127,  0.0777,  0.1737,  0.1386]]],


        [[[ 0.0729, -0.2183,  0.0282,  0.1541,  0.2333],
          [ 0.0935, -0.2089,  0.0342, -0.1277,  0.0993],
          [-0.0240, -0.1592, -0.1458,  0.0469,  0.1851],
          [-0.0631, -0.1873, -0.1529,  0.0560, -0.0278],
          [-0.1315, -0.0299, -0.1137,  0.1413, -0.0673]]],


        [[[-0.0915,  0.0546, -0.1495, -0.0188,  0.0252],
          [ 0.1788, -0.0121, -0.0713, -0.0897,  0.1218],
          [ 0.0853,  0.0481, -0.1803, -0.2182,  0.0363],
          [-0.1325,  0.1499, -0.0039, -0.0272,  0.1048],
          [ 0.0839,  0.1095,  0.0680, -0.1718,  0.0756]]],


        [[[-0.1685,  0.1923, -0.0752,  0.1228, -0.0222],
          [ 0.0400, -0.0173, -0.0606, -0.0977, -0.1063],
          [ 0.0864,  0.1187,  0.0591, -0.2335, -0.0149],
          [ 0.1564, -0.1382, -0.2423,  0.0533,  0.1177],
          [-0.0994, -0.0974, -0.1585,  0.0631,  0.1641]]],


        [[[-0.1812, -0.0125,  0.1244,  0.1692,  0.1426],
          [ 0.0819, -0.0832,  0.0621,  0.1176, -0.1229],
          [ 0.1396,  0.0004, -0.2155, -0.1897, -0.0748],
          [-0.1782,  0.1505, -0.1061, -0.0291,  0.2037],
          [-0.0674,  0.1281, -0.1199,  0.0179, -0.0847]]],


        [[[ 0.1288,  0.0718,  0.1671, -0.1934, -0.0293],
          [ 0.0346,  0.1025,  0.0840, -0.0646,  0.1736],
          [-0.0574,  0.1934, -0.1984,  0.1795,  0.2261],
          [-0.1525,  0.1459,  0.0437,  0.0350, -0.0594],
          [ 0.0877,  0.1472,  0.0160,  0.1826,  0.0653]]],


        [[[ 0.1016, -0.0069,  0.0533, -0.1622,  0.0218],
          [-0.0585,  0.1739,  0.1226,  0.1046, -0.0360],
          [-0.1102, -0.1267,  0.0970,  0.1387, -0.0696],
          [-0.0485, -0.1970, -0.2318,  0.0652,  0.1692],
          [ 0.0841,  0.0711, -0.0314, -0.1681, -0.1181]]],


        [[[-0.2016,  0.0881, -0.0680, -0.1268,  0.0646],
          [ 0.0080, -0.0707, -0.1882, -0.1555, -0.0903],
          [-0.1938, -0.0995, -0.0860, -0.1065,  0.0408],
          [-0.1133, -0.0752, -0.0083,  0.0870,  0.1358],
          [ 0.1266, -0.1398,  0.2034,  0.1959,  0.0567]]],


        [[[ 0.0567, -0.1177,  0.1067, -0.0744, -0.0882],
          [-0.1515, -0.1387, -0.0812,  0.0709, -0.1068],
          [ 0.0920,  0.0816, -0.2218,  0.0880,  0.0453],
          [ 0.0975, -0.1942, -0.0022,  0.1221,  0.0318],
          [ 0.1234, -0.1892,  0.0173,  0.1882, -0.0748]]],


        [[[ 0.0612,  0.0493, -0.1081,  0.0890,  0.0925],
          [-0.0954,  0.0954,  0.0063,  0.0804,  0.1404],
          [ 0.0818, -0.1073,  0.0536,  0.0272,  0.1601],
          [-0.0324,  0.1026,  0.2012,  0.1356,  0.1472],
          [ 0.1898,  0.1245, -0.0559,  0.0924,  0.1931]]],


        [[[ 0.1521, -0.1404, -0.2413, -0.0839,  0.1632],
          [ 0.0461,  0.1208,  0.1407,  0.1950,  0.1628],
          [-0.0755,  0.0586,  0.1571, -0.1610, -0.0088],
          [ 0.0221, -0.1504, -0.0914,  0.0053, -0.0014],
          [-0.0077, -0.1010,  0.0855, -0.0786, -0.1271]]],


        [[[ 0.0154,  0.0897, -0.0534, -0.0665, -0.0114],
          [ 0.2115,  0.0793, -0.1698,  0.0467, -0.0953],
          [ 0.0647,  0.1659,  0.1003, -0.0423,  0.0895],
          [-0.0500,  0.1648, -0.0619,  0.1430, -0.0068],
          [ 0.2374, -0.1516, -0.1329,  0.1650, -0.1665]]],


        [[[-0.1991, -0.1201, -0.1374,  0.1200, -0.0657],
          [ 0.1786,  0.1776, -0.0045, -0.0054,  0.1048],
          [ 0.1015, -0.1367,  0.1418, -0.0676,  0.0725],
          [ 0.0250, -0.0837,  0.1749, -0.0451,  0.1111],
          [-0.0175, -0.1828,  0.1457, -0.0045,  0.1681]]],


        [[[ 0.0248,  0.0909, -0.1452,  0.1429,  0.0520],
          [-0.1028,  0.2008,  0.0356,  0.1819,  0.1378],
          [ 0.1591, -0.1652, -0.1658, -0.0528, -0.0429],
          [-0.2151, -0.0169, -0.2023, -0.1701,  0.0902],
          [-0.1348, -0.0447,  0.0559, -0.0778, -0.0602]]],


        [[[-0.1195, -0.0334, -0.0168,  0.1920,  0.1201],
          [-0.1073, -0.1581,  0.0667,  0.0515, -0.0997],
          [-0.1552, -0.0172, -0.0088,  0.1208,  0.2260],
          [-0.1368, -0.2084,  0.0613,  0.1079, -0.0813],
          [ 0.0495, -0.1583,  0.1164, -0.1105,  0.2100]]]])





    # For each 5x5 slice (axis 2,3):
    # max positive inner product: choose 255 where x > 0, 0 otherwise
    max_pos = 255 * np.maximum(x, 0).sum(axis=(2, 3))

    # max negative inner product: choose 255 where x < 0, 0 otherwise
    max_neg = 255 * np.minimum(x, 0).sum(axis=(2, 3))

    # maximum absolute inner product per slice
    max_abs = np.maximum(np.abs(max_pos), np.abs(max_neg))

    global_max_abs = max_abs.max()

    scaled_max = global_max_abs * 10000

    prime_minimum = scaled_max * 2

    print("Max positive per slice:", max_pos.ravel())
    print("Max negative per slice:", max_neg.ravel())
    print("Max absolute per slice:", max_abs.ravel())
    print("Maximum absolute inner product over all slices:", global_max_abs)
    print("Scaled maximum absolute inner product (x10000):", scaled_max)
    print("Suggested prime minimum (scaled max * 2):", prime_minimum)

